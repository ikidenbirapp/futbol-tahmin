<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Analiz - Kesintisiz</title>
    <style>
        :root { --accent: #f39c12; --bg: #0b0b0b; --card-bg: #181818; }
        body { background-color: var(--bg); color: #fff; font-family: 'Segoe UI', sans-serif; margin: 0; padding: 15px; }
        .header { text-align: center; padding: 10px; border-bottom: 2px solid var(--accent); margin-bottom: 20px; }
        .card { background: var(--card-bg); border-radius: 16px; padding: 18px; margin-bottom: 20px; border-left: 5px solid var(--accent); }
        .league { font-size: 10px; color: #888; text-transform: uppercase; }
        .match-row { display: flex; justify-content: space-between; align-items: center; margin: 15px 0; font-weight: bold; font-size: 16px; }
        .vs { color: var(--accent); background: #222; padding: 4px 8px; border-radius: 6px; font-size: 11px; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .item { background: #222; padding: 10px; border-radius: 10px; text-align: center; border: 1px solid #333; }
        .label { display: block; font-size: 8px; color: #888; text-transform: uppercase; }
        .val { font-size: 13px; font-weight: bold; color: #2ecc71; }
        .btn { width: 100%; background: var(--accent); color: #000; border: none; padding: 12px; border-radius: 10px; font-weight: bold; margin-top: 15px; cursor: pointer; }
        .res { display: none; margin-top: 15px; padding: 12px; background: #000; border-radius: 10px; border: 1px dashed var(--accent); font-size: 13px; color: #ddd; }
        #loading { text-align: center; color: var(--accent); padding: 50px; }
    </style>
</head>
<body>

    <div class="header"><h3>AI TAHMİN ANALİZ</h3></div>
    <div id="loading">AI Veri Tabanına Bağlanılıyor...</div>
    <div id="content"></div>

    <script>
        const API_TOKEN = "f950a4eff9b749b48764a00afb4012a0";

        const archiveMatches = [
            { league: "PREMIER LEAGUE", home: "Manchester City", away: "Liverpool", time: "20:00" },
            { league: "LA LIGA", home: "Barcelona", away: "Atl. Madrid", time: "21:30" },
            { league: "SERIE A", home: "Inter", away: "AC Milan", time: "22:45" },
            { league: "BUNDESLIGA", home: "Bayern Munich", away: "Dortmund", time: "19:30" }
        ];

        function getAIComment(h, a) {
            const comments = [
                `${h} takımı son haftalarda evinde çok agresif. Erken gol bulma şansı %82.`,
                `${a} deplasmanda savunma disipliniyle tanınır. 2.5 Alt seçeneği ön planda.`,
                `Yapay zeka modellerimiz bu maçta orta saha mücadelesinin skor belirleyici olacağını söylüyor.`,
                `İstatistiksel olarak KG VAR ihtimali yüksek bir karşılaşma.`
            ];
            return comments[Math.floor(Math.random() * comments.length)];
        }

        function analyze(btn, h, a) {
            const r = btn.nextElementSibling;
            if(r.style.display === "block") {
                r.style.display = "none";
                btn.innerText = "ANALİZ YAP";
            } else {
                r.innerHTML = "<strong>AI Analizi:</strong> " + getAIComment(h, a);
                r.style.display = "block";
                btn.innerText = "KAPAT";
            }
        }

        async function init() {
            const content = document.getElementById('content');
            const loading = document.getElementById('loading');
            
            try {
                const res = await fetch('https://api.football-data.org/v4/matches', {
                    headers: { 'X-Auth-Token': API_TOKEN }
                });
                
                if (!res.ok) throw new Error(); 
                const data = await res.json();
                
                if(data.matches && data.matches.length > 0) {
                    render(data.matches.map(m => ({
                        league: m.competition.name,
                        home: m.homeTeam.shortName || m.homeTeam.name,
                        away: m.awayTeam.shortName || m.awayTeam.name,
                        time: new Date(m.utcDate).getHours() + ":" + String(new Date(m.utcDate).getMinutes()).padStart(2, '0')
                    })));
                } else {
                    throw new Error();
                }
            } catch (e) {
                console.log("Limit doldu, arşive geçiliyor...");
                render(archiveMatches);
            }
            loading.style.display = "none";
        }

        function render(matches) {
            const content = document.getElementById('content');
            matches.slice(0, 10).forEach(m => {
                content.innerHTML += `
                    <div class="card">
                        <div style="display:flex; justify-content:space-between">
                            <span class="league">${m.league}</span>
                            <span style="font-size:10px; color:#666">${m.time}</span>
                        </div>
                        <div class="match-row">
                            <span>${m.home}</span>
                            <span class="vs">VS</span>
                            <span>${m.away}</span>
                        </div>
                        <div class="grid">
                            <div class="item"><span class="label">Tahmin</span><span class="val">MS 1</span></div>
                            <div class="item"><span class="label">AI Güven</span><span class="val">%${Math.floor(Math.random()*15)+80}</span></div>
                        </div>
                        <button class="btn" onclick="analyze(this, '${m.home}', '${m.away}')">ANALİZ YAP</button>
                        <div class="res"></div>
                    </div>`;
            });
        }
        init();
    </script>
</body>
</html>
